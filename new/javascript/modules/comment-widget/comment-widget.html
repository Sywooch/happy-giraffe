<!-- comment-widget -->
<div id="commentsList" class="comments_hold tab-pane active" data-bind="visible: parsedData().length > 0">
  <div class="comments_add" data-bind="if: parsedData().length">
    <div class="comments_add-frame">
      <div class="comments_i clearfix">
        <div class="comments_ava">
          <!-- Аватарки размером 40*40-->
          <!-- ava-->
          <a href="" class="ava ava__middle ava__small-sm-mid" data-bind="href: authUser.profileUrl()"><img alt="" src="" class="ava_img" data-bind="src: authUser.avatarUrl()"></a>
        </div>
        <div class="comments_frame">
          <!-- ko ifnot: editing -->
          <textarea placeholder=" Введите ваш комментарий " rows="3" cols="30" class="itx-simple" data-bind="click: setEditing"></textarea>
          <!-- /ko -->
            <!-- ko if: editing -->
            <div class="redactor-control">
              <div class="redactor-control_toolbar"></div>
              <div class="redactor-control_hold">
                <textarea cols="40" name="redactor" rows="1" autofocus="autofocus" class="redactor" data-bind="wswgHG: { config : editorConfig, attr : editor }"></textarea>
              </div>
              <div class="redactor-control_control clearfix">
                <div class="float-r">
                  <button class="btn-green" data-bind="click: addComment">Отправить</button>
                </div>
              </div>
            </div>
            <!-- /ko -->

        </div>
      </div>
    </div>
  </div>
   <ul class="comments_ul" data-bind="foreach: { data: parsedData(), as: 'comment' }">
      <li class="comments_li comments_li__lilac" data-bind="attr { class: 'comments_li comments_li__' + color() }">

        <!-- ko ifnot: comment.removed -->
         <div class="comments_i clearfix" >
             <div class="comments_ava">
                 <a href="" class="ava ava__middle ava__small-sm-mid" data-bind="href: comment.user.profileUrl()"><img alt="" src="" class="ava_img" data-bind="src: comment.user.avatarUrl()"></a>
             </div>
             <div class="comments_frame">
                 <div class="comments_header">
                     <a href="" rel="author" class="a-light comments_author" data-bind="text: comment.user.fullName(), href: comment.user.profileUrl()"></a>
                     <time datetime="" class="tx-date" data-bind="attr: { datetime: moment.unix(comment.dtimeCreate()).format('YYYY-MM-DD') }, moment: comment.dtimeCreate"></time>
                 </div>
                 <div class="comments_cont">

                    <!-- ko if: $parent.authUser.id() === comment.user.id() -->

                      <!-- ko if: comment.editingCurrent -->

                          <div class="redactor-control">
                            <div class="redactor-control_toolbar"></div>
                            <div class="redactor-control_hold">
                              <textarea cols="40" name="redactor" rows="1" autofocus="autofocus" class="redactor" data-bind="wswgHG: { config : $parent.editorConfig, attr : comment.editor }"></textarea>
                            </div>
                            <div class="redactor-control_control clearfix">
                              <div class="float-r">
                                <button class="btn-green" data-bind="click: renewComment">Отправить</button>
                              </div>
                            </div>
                          </div>

                        <!-- /ko -->

                        <!-- ko ifnot: comment.editingCurrent -->

                        <div class="wysiwyg-content" data-bind="html: comment.purifiedHtml">
                        </div>

                       <!-- /ko -->

                    <!-- /ko -->

                    <!-- ko if: $parent.authUser.id() !== comment.user.id() -->

                       <div class="wysiwyg-content" data-bind="html: comment.purifiedHtml">
                        </div>

                    <!-- /ko -->

                 </div>
                <div class="comments_footer">

                  <!-- b-control-->

                  <div class="b-control">
                    <div class="b-control_i b-control_i__answer" data-bind="click: response"><span class="b-control_ico"></span><span class="b-control_tx">Ответить</span></div>

                    <!-- ko if: $parent.authUser.id() === comment.user.id() -->

                      <div class="b-control_i b-control_i__delete" data-bind="click: remove"><span class="b-control_ico"></span><span class="b-control_tx">Удалить</span>
                      </div>

                        <!-- ko ifnot: comment.editingCurrent -->

                          <div class="b-control_i b-control_i__edit" data-bind="click: edit"><span class="b-control_ico"></span><span class="b-control_tx">Редактировать</span></div>

                        <!-- /ko -->

                    <!-- /ko -->

                  </div>
                  <!-- /b-control-->

                </div>
             </div>
          </div>

          <!-- ko if: comment.answering -->

              <div class="comments-gray_add clearfix">
                  <div class="comments_ava">
                      <a href="" class="ava ava__middle ava__small-sm-mid" data-bind="href: $parent.authUser.profileUrl()"><img alt="" src="" class="ava_img" data-bind="src: $parent.authUser.avatarUrl()"></a>
                  </div>
                  <div class="comments-gray_frame">
                      <div class="redactor-control">
                          <div class="redactor-control_toolbar"></div>
                          <div class="redactor-control_hold">
                              <textarea cols="40" name="redactor" rows="1" autofocus="autofocus" class="redactor" data-bind="wswgHG: { config : $parent.editorConfig, attr : comment.editor }"></textarea>
                          </div>
                          <div class="redactor-control_control clearfix">
                              <div class="float-r">
                                  <button class="btn-green" data-bind="click: comment.create($parent.modelParams)">Отправить</button>
                              </div>
                          </div>
                      </div>
                  </div>
              </div>

          <!-- /ko -->

        <!-- /ko -->

        <!-- ko if: comment.removed -->
          <!-- ko if: $parent.authUser.id() === comment.user.id() -->
          <div class="im-message_tx color-gray" data-bind="click: restore">Сообщение удалено. <a href="#" class="font-s">Восстановить</a></div>
          <!-- /ko -->
        <!-- /ko -->

          <ul class="comments_ul" data-bind="if comment.answers.length > 0, foreach: { data: comment.answers(), as: 'commentInner' }">
            <li class="comments_li comments_li__lilac" data-bind="attr { class: 'comments_li comments_li__' + $parent.color() }">
               <div class="comments_i clearfix">
                   <div class="comments_ava">
                       <a href="" class="ava ava__middle ava__small-sm-mid" data-bind="href: commentInner.user.profileUrl()"><img alt="" src="" class="ava_img" data-bind="src: commentInner.user.avatarUrl()"></a>
                   </div>
                   <div class="comments_frame">
                       <div class="comments_header">
                           <a href="" rel="author" class="a-light comments_author" data-bind="text: commentInner.user.fullName(), href: commentInner.user.profileUrl()"></a>
                           <time datetime="" class="tx-date" data-bind="attr: { datetime: moment.unix(commentInner.dtimeCreate()).format('YYYY-MM-DD') }, moment: commentInner.dtimeCreate"></time>
                       </div>
                       <div class="comments_cont">
                           <!-- ko if: $parents[1].authUser.id() === commentInner.user.id() -->

                               <!-- ko if: commentInner.editingCurrent -->

                                   <div class="redactor-control">
                                       <div class="redactor-control_toolbar"></div>
                                       <div class="redactor-control_hold">
                                           <textarea cols="40" name="redactor" rows="1" autofocus="autofocus" class="redactor" data-bind="wswgHG: { config : $parents[1].editorConfig, attr : commentInner.editor }"></textarea>
                                       </div>
                                       <div class="redactor-control_control clearfix">
                                           <div class="float-r">
                                               <button class="btn-green" data-bind="click: commentInner.renewComment">Отправить</button>
                                           </div>
                                       </div>
                                   </div>

                               <!-- /ko -->

                               <!-- ko ifnot: commentInner.editingCurrent -->

                               <div class="wysiwyg-content" data-bind="html: commentInner.purifiedHtml">
                               </div>

                               <!-- /ko -->

                           <!-- /ko -->

                           <!-- ko if: $parents[1].authUser.id() !== commentInner.user.id() -->

                           <div class="wysiwyg-content" data-bind="html: commentInner.purifiedHtml">
                           </div>

                           <!-- /ko -->
                       </div>
                      <div class="comments_footer">
                        <!-- b-control-->
                        <div class="b-control">
                          <div class="b-control_i b-control_i__answer" data-bind="click: commentInner.response"><span class="b-control_ico"></span><span class="b-control_tx">Ответить</span>
                          </div>
                          <!-- ko if: $parents[1].authUser.id() === comment.user.id() -->
                          <div class="b-control_i b-control_i__delete" data-bind="click: commentInner.remove"><span class="b-control_ico"></span><span class="b-control_tx">Удалить</span>
                          </div>
                          <div class="b-control_i b-control_i__edit" data-bind="click: commentInner.edit"><span class="b-control_ico"></span><span class="b-control_tx">Редактировать</span>
                          </div>
                          <!-- /ko -->
                        </div>
                        <!-- /b-control-->
                      </div>
                   </div>
              </div>
                <!-- ko if: commentInner.answering -->

                <div class="comments-gray_add clearfix">
                    <div class="comments_ava">
                        <a href="" class="ava ava__middle ava__small-sm-mid" data-bind="href: $parents[1].authUser.profileUrl()"><img alt="" src="" class="ava_img" data-bind="src: $parents[1].authUser.avatarUrl()"></a>
                    </div>
                    <div class="comments-gray_frame">
                        <div class="redactor-control">
                            <div class="redactor-control_toolbar"></div>
                            <div class="redactor-control_hold">
                                <textarea cols="40" name="redactor" rows="1" autofocus="autofocus" class="redactor" data-bind="wswgHG: { config : $parents[1].editorConfig, attr : commentInner.editor }"></textarea>
                            </div>
                            <div class="redactor-control_control clearfix">
                                <div class="float-r">
                                    <button class="btn-green" data-bind="click: commentInner.create($parents[1].modelParams)">Отправить</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- /ko -->
            </li>
         </ul>
      </li>
   </ul>
</div>
<!-- /comment-widget -->